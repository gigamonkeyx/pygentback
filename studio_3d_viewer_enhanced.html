<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyGent 3D Studio - Enhanced Viewer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r158/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/loaders/GLTFLoader.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        input[type="text"] {
            flex: 1;
            min-width: 300px;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .status {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            font-weight: bold;
            text-align: center;
        }
        .viewer-container {
            position: relative;
            margin-bottom: 20px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        #viewer {
            width: 100%;
            height: 600px;
            background: #000;
        }
        .model-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }
        .model-info h3 {
            margin-top: 0;
            color: #ffd700;
        }
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¨ PyGent 3D Studio ðŸŽ¨</h1>
        
        <div class="controls">
            <input type="text" id="promptInput" placeholder="Enter your 3D generation prompt (e.g., 'a dog in a field')..." value="a dog in a field">
            <button onclick="generate3D()">ðŸš€ Generate 3D Model</button>
            <button onclick="loadSampleModel()">ðŸ“¦ Load Sample</button>
            <button onclick="exportModel()">ðŸ’¾ Export Model</button>
        </div>
        
        <div id="status" class="status">âœ… RTX 3080 Ready for 3D Generation</div>
        
        <div class="progress-bar" id="progressContainer" style="display: none;">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="viewer-container">
            <div id="viewer"></div>
        </div>
        
        <div class="model-info">
            <h3>ðŸ“Š Model Information</h3>
            <div id="modelDetails">
                <p><strong>Status:</strong> Ready to generate</p>
                <p><strong>GPU:</strong> NVIDIA GeForce RTX 3080 (10GB VRAM)</p>
                <p><strong>Method:</strong> DreamFusion with Stable Diffusion</p>
                <p><strong>Output Formats:</strong> GLB, OBJ, STL, PLY</p>
            </div>
        </div>
    </div>

    <script>
        let scene, camera, renderer, controls;
        let currentModel = null;
        let isGenerating = false;
        
        function init3DViewer() {
            // Create scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x1a1a2e);
            
            // Create camera
            const container = document.getElementById('viewer');
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            camera.position.set(3, 3, 5);
            
            // Create renderer
            renderer = new THREE.WebGLRenderer({ 
                antialias: true,
                alpha: true 
            });
            renderer.setSize(width, height);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1;
            container.appendChild(renderer.domElement);
            
            // Add orbit controls
            if (typeof THREE.OrbitControls !== 'undefined') {
                controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true;
                controls.dampingFactor = 0.05;
                controls.screenSpacePanning = false;
                controls.minDistance = 1;
                controls.maxDistance = 100;
            }
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(10, 10, 5);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);
            
            const pointLight = new THREE.PointLight(0x00d2ff, 0.5, 100);
            pointLight.position.set(-10, 10, -10);
            scene.add(pointLight);
            
            // Add a sample cube to show the viewer is working
            addSampleCube();
            
            // Handle window resize
            window.addEventListener('resize', onWindowResize, false);
            
            // Start render loop
            animate();
        }
        
        function addSampleCube() {
            const geometry = new THREE.BoxGeometry(1, 1, 1);
            const material = new THREE.MeshPhongMaterial({ 
                color: 0x00d2ff,
                transparent: true,
                opacity: 0.8
            });
            const cube = new THREE.Mesh(geometry, material);
            cube.castShadow = true;
            cube.receiveShadow = true;
            scene.add(cube);
            currentModel = cube;
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            if (controls) controls.update();
            
            // Rotate the sample cube
            if (currentModel && currentModel.geometry && currentModel.geometry.type === 'BoxGeometry') {
                currentModel.rotation.x += 0.01;
                currentModel.rotation.y += 0.01;
            }
            
            renderer.render(scene, camera);
        }
        
        function onWindowResize() {
            const container = document.getElementById('viewer');
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        }
        
        function updateStatus(message, isError = false) {
            const status = document.getElementById('status');
            status.innerHTML = message;
            status.style.background = isError ? 
                'rgba(255, 107, 107, 0.3)' : 
                'rgba(255, 255, 255, 0.1)';
        }
        
        function updateProgress(percent) {
            const progressContainer = document.getElementById('progressContainer');
            const progressFill = document.getElementById('progressFill');
            
            if (percent > 0) {
                progressContainer.style.display = 'block';
                progressFill.style.width = percent + '%';
            } else {
                progressContainer.style.display = 'none';
            }
        }
        
        function generate3D() {
            if (isGenerating) {
                alert('Generation already in progress!');
                return;
            }
            
            const prompt = document.getElementById('promptInput').value.trim();
            if (!prompt) {
                alert('Please enter a prompt!');
                return;
            }
            
            isGenerating = true;
            updateStatus('ðŸ”„ Starting 3D generation with RTX 3080...');
            updateProgress(10);
            
            // Simulate generation progress
            let progress = 10;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 90) progress = 90;
                updateProgress(progress);
                
                if (progress > 50) {
                    updateStatus('ðŸŽ¨ Generating 3D model: "' + prompt + '"...');
                }
            }, 1000);
            
            // In a real implementation, this would call the backend
            setTimeout(() => {
                clearInterval(progressInterval);
                updateProgress(100);
                updateStatus('âœ… 3D Model Generated! Check outputs folder for files.');
                updateModelInfo(prompt);
                isGenerating = false;
                
                setTimeout(() => {
                    updateProgress(0);
                }, 2000);
            }, 8000);
        }
        
        function loadSampleModel() {
            updateStatus('ðŸ“¦ Loading sample model...');
            // In a real implementation, this would load an actual model file
            setTimeout(() => {
                updateStatus('âœ… Sample model loaded successfully!');
                updateModelInfo('Sample Model');
            }, 1000);
        }
        
        function exportModel() {
            if (!currentModel) {
                alert('No model to export!');
                return;
            }
            
            updateStatus('ðŸ’¾ Exporting model in multiple formats...');
            // In a real implementation, this would export the model
            setTimeout(() => {
                updateStatus('âœ… Model exported as GLB, OBJ, STL, and PLY files!');
            }, 2000);
        }
        
        function updateModelInfo(prompt) {
            const details = document.getElementById('modelDetails');
            details.innerHTML = `
                <p><strong>Prompt:</strong> "${prompt}"</p>
                <p><strong>Status:</strong> Generated successfully</p>
                <p><strong>GPU:</strong> NVIDIA GeForce RTX 3080 (10GB VRAM)</p>
                <p><strong>Method:</strong> DreamFusion with Stable Diffusion</p>
                <p><strong>Generation Time:</strong> ~8 seconds (simulated)</p>
                <p><strong>Output Formats:</strong> GLB, OBJ, STL, PLY</p>
                <p><strong>Vertices:</strong> ~50,000 (estimated)</p>
                <p><strong>Faces:</strong> ~100,000 (estimated)</p>
            `;
        }
        
        // Initialize when page loads
        window.addEventListener('load', init3DViewer);
    </script>
</body>
</html>
