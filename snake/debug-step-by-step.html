<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Step by Step Loading</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #001122;
            color: #00ffff;
            font-family: monospace;
        }
        
        .debug-section {
            background: rgba(0,0,0,0.5);
            border: 1px solid #00ffff;
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
        }
        
        .status {
            padding: 5px;
            margin: 2px 0;
        }
        
        .success { color: #00ff00; }
        .error { color: #ff0000; }
        .warning { color: #ffff00; }
        
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        canvas {
            border: 2px solid #00ffff;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üîç Debug - Step by Step Loading</h1>
    
    <div class="debug-section">
        <h3>üìã Loading Status</h3>
        <div id="loading-status"></div>
    </div>
    
    <div class="debug-section">
        <h3>üéÆ Test Controls</h3>
        <button onclick="testBasicFunctions()">Test Basic Functions</button>
        <button onclick="testSnakeGeneration()">Test Snake Generation</button>
        <button onclick="testCanvasDrawing()">Test Canvas Drawing</button>
        <button onclick="testBattleStart()">Test Battle Start</button>
    </div>
    
    <div class="debug-section">
        <h3>üñ•Ô∏è Canvas Test</h3>
        <canvas id="debug-canvas" width="400" height="300"></canvas>
    </div>
    
    <div class="debug-section">
        <h3>üìä Console Output</h3>
        <div id="console-output" style="height: 200px; overflow-y: auto; background: #000; padding: 10px;"></div>
    </div>

    <script>
        // Debug logging
        const statusDiv = document.getElementById('loading-status');
        const consoleDiv = document.getElementById('console-output');
        
        function addStatus(message, type = 'info') {
            const statusItem = document.createElement('div');
            statusItem.className = `status ${type}`;
            statusItem.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            statusDiv.appendChild(statusItem);
            statusDiv.scrollTop = statusDiv.scrollHeight;
        }
        
        function addConsole(message, type = 'log') {
            const consoleItem = document.createElement('div');
            consoleItem.style.color = type === 'error' ? '#ff6666' : '#00ffff';
            consoleItem.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            consoleDiv.appendChild(consoleItem);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }
        
        // Override console
        const originalLog = console.log;
        const originalError = console.error;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addConsole(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addConsole(args.join(' '), 'error');
            addStatus('ERROR: ' + args.join(' '), 'error');
        };
        
        // Test functions
        function testBasicFunctions() {
            addStatus('Testing basic functions...', 'info');
            
            try {
                const canvas = document.getElementById('debug-canvas');
                const ctx = canvas.getContext('2d');
                
                ctx.fillStyle = '#00ff00';
                ctx.fillRect(10, 10, 50, 50);
                ctx.fillStyle = '#ffffff';
                ctx.font = '16px Arial';
                ctx.fillText('Canvas OK', 70, 30);
                
                addStatus('‚úÖ Canvas drawing works', 'success');
            } catch (error) {
                addStatus('‚ùå Canvas error: ' + error.message, 'error');
            }
        }
        
        function testSnakeGeneration() {
            addStatus('Testing snake generation...', 'info');
            
            try {
                if (typeof EliteSnakeGenerator !== 'undefined') {
                    const generator = new EliteSnakeGenerator();
                    const snake = generator.generateEliteSnake();
                    addStatus(`‚úÖ Generated snake: ${snake.name}`, 'success');
                    console.log('Snake data:', snake);
                } else {
                    addStatus('‚ùå EliteSnakeGenerator not found', 'error');
                }
            } catch (error) {
                addStatus('‚ùå Snake generation error: ' + error.message, 'error');
            }
        }
        
        function testCanvasDrawing() {
            addStatus('Testing canvas drawing...', 'info');
            
            try {
                const canvas = document.getElementById('debug-canvas');
                const ctx = canvas.getContext('2d');
                
                // Clear canvas
                ctx.fillStyle = '#001122';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Draw test pattern
                ctx.strokeStyle = '#00ffff';
                ctx.lineWidth = 2;
                
                // Draw grid
                for (let x = 0; x < canvas.width; x += 20) {
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, canvas.height);
                    ctx.stroke();
                }
                
                for (let y = 0; y < canvas.height; y += 20) {
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(canvas.width, y);
                    ctx.stroke();
                }
                
                // Draw center text
                ctx.fillStyle = '#ffff00';
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Grid Test', canvas.width / 2, canvas.height / 2);
                
                addStatus('‚úÖ Canvas drawing test complete', 'success');
            } catch (error) {
                addStatus('‚ùå Canvas drawing error: ' + error.message, 'error');
            }
        }
        
        function testBattleStart() {
            addStatus('Testing battle start...', 'info');
            
            try {
                if (window.eliteGameMaster) {
                    addStatus('‚úÖ Game Master found', 'success');
                    
                    if (eliteGameMaster.isInitialized) {
                        addStatus('‚úÖ Game Master initialized', 'success');
                        eliteGameMaster.startDemoBattle();
                        addStatus('‚úÖ Demo battle started', 'success');
                    } else {
                        addStatus('‚ùå Game Master not initialized', 'error');
                    }
                } else {
                    addStatus('‚ùå Game Master not found', 'error');
                }
            } catch (error) {
                addStatus('‚ùå Battle start error: ' + error.message, 'error');
            }
        }
        
        // Start loading scripts
        addStatus('üîÑ Starting script loading...', 'info');
    </script>

    <!-- Load scripts one by one with status reporting -->
    <script>
        addStatus('üìú Loading EliteSnakeGenerator...', 'info');
    </script>
    <script src="elite-snake-generator.js" onload="addStatus('‚úÖ EliteSnakeGenerator loaded', 'success')" onerror="addStatus('‚ùå EliteSnakeGenerator failed', 'error')"></script>
    
    <script>
        addStatus('üìú Loading EliteVisualEffects...', 'info');
    </script>
    <script src="elite-visual-effects.js" onload="addStatus('‚úÖ EliteVisualEffects loaded', 'success')" onerror="addStatus('‚ùå EliteVisualEffects failed', 'error')"></script>
    
    <script>
        addStatus('üìú Loading EliteBattleEngine...', 'info');
    </script>
    <script src="elite-battle-engine.js" onload="addStatus('‚úÖ EliteBattleEngine loaded', 'success')" onerror="addStatus('‚ùå EliteBattleEngine failed', 'error')"></script>
    
    <script>
        addStatus('üìú Loading EliteEvolutionSystem...', 'info');
    </script>
    <script src="elite-evolution-system.js" onload="addStatus('‚úÖ EliteEvolutionSystem loaded', 'success')" onerror="addStatus('‚ùå EliteEvolutionSystem failed', 'error')"></script>
    
    <script>
        addStatus('üìú Loading EliteTournamentSystem...', 'info');
    </script>
    <script src="elite-tournament-system.js" onload="addStatus('‚úÖ EliteTournamentSystem loaded', 'success')" onerror="addStatus('‚ùå EliteTournamentSystem failed', 'error')"></script>
    
    <script>
        addStatus('üìú Loading EliteGameMaster...', 'info');
    </script>
    <script src="elite-game-master-clean.js" onload="addStatus('‚úÖ EliteGameMaster loaded', 'success')" onerror="addStatus('‚ùå EliteGameMaster failed', 'error')"></script>
    
    <script>
        // Final initialization check
        setTimeout(() => {
            addStatus('üîç Checking final state...', 'info');
            
            if (window.eliteGameMaster) {
                addStatus('‚úÖ Game Master instance found', 'success');
                if (eliteGameMaster.isInitialized) {
                    addStatus('üéÆ Game ready for testing!', 'success');
                } else {
                    addStatus('‚è≥ Game Master still initializing...', 'warning');
                }
            } else {
                addStatus('‚ùå No Game Master instance found', 'error');
            }
        }, 2000);
    </script>
</body>
</html>
